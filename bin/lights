#!/usr/bin/env ruby

require "json"
require "pry"

mode = ARGV[0].to_sym

unless %i(on off).include?(mode)
  puts "You can turn the lights on or off, there are no other options"
  exit
end

puts "Turning lights #{mode}..."

settings = {
  on: {
    atom: ["one-light-ui", "one-light-syntax"],
    shell: "United-Ubuntu",
    gtk: "United-Ubuntu",
  },
  off: {
    atom: ["one-dark-ui", "one-dark-syntax"],
    shell: "United-Ubuntu-Dark",
    gtk: "United-Ubuntu-Dark",
  },
}

atom_config_path = File.join(File.expand_path(__dir__), "..", "atom.symlink", "config.json")
atom_config = JSON.parse(File.read(atom_config_path))

atom_config["*"]["core"]["themes"] = settings[mode][:atom]

File.open(atom_config_path, "w") do |config|
  config << JSON.pretty_generate(atom_config)
end

system("gsettings set org.gnome.desktop.interface gtk-theme \"#{settings[mode][:gtk]}\"")
system("dconf write /org/gnome/shell/extensions/user-theme/name \"'#{settings[mode][:shell]}'\"")
